---
author: Suraj TC
date: 2024-07-09
tags: computer vision, opencv, tutorial

meta:
  title: Hand Recognition using OpenCV and Mediapipe
  description: This is a short guide to using Mediapipe with OpenCV for hand recognition and processing hand landmarks

  twitter:title:
  twitter:description:
---

## {frontmatter.meta.title}

{frontmatter.meta.description}

Posted on: {frontmatter.date}

```sh
# make venv
python -m venv .venv
source ./.venv/bin/activate

# install deps
pip install opencv-python mediapipe
```

```python
import cv2
import mediapipe as mp

# define constants
WINDOW_NAME = "Hand Detection TEST"
FRAME_WIDTH = 1280
FRAME_HEIGHT = 720

# import mediapie hand tracking utils
mp_drawing = mp.solutions.drawing_utils
mp_drawing_styles = mp.solutions.drawing_styles
mp_hands = mp.solutions.hands

# set video caputring device (0-based index)
cap = cv2.VideoCapture(4)

# adjust frame width and height (some devices doesn't support this option)
cap.set(cv2.CAP_PROP_FRAME_WIDTH, FRAME_WIDTH)
cap.set(cv2.CAP_PROP_FRAME_HEIGHT, FRAME_HEIGHT)

print(f'w: {cap.get(cv2.CAP_PROP_FRAME_WIDTH)} \
        h: {cap.get(cv2.CAP_PROP_FRAME_HEIGHT)}')

# process capture device data with opencv
with mp_hands.Hands(
    model_complexity = 1,
    min_detection_confidence = 0.5,
    min_tracking_confidence = 0.5) as hands:
    while cap.isOpened():
        success, img = cap.read()

        # skip if no image data
        if not success:
            print("Skipping Empty Frame")
            continue

        # set writeable flag to false for faster processing and convert BGR to RGB for mp
        img.flags.writeable = False
        img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)
        results = hands.process(img)

        img.flags.writeable = True
        img = cv2.cvtColor(img, cv2.COLOR_RGB2BGR)

        # draw detected hands
        if results.multi_hand_landmarks:
            for hand_landmarks in results.multi_hand_landmarks:
                mp_drawing.draw_landmarks(
                    img,
                    hand_landmarks,
                    mp_hands.HAND_CONNECTIONS,
                    mp_drawing_styles.get_default_hand_landmarks_style(),
                    mp_drawing_styles.get_default_hand_connections_style()
                )
        
        # filp the image and display it
        cv2.imshow(WINDOW_NAME, cv2.flip(img, 1))
        
        # destroy window when 'Esc' button is pressed
        if cv2.pollKey() & 0xFF == 27:
            cv2.destroyWindow(WINDOW_NAME) 
            cap.release()
            break

```